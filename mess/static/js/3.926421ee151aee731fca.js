webpackJsonp([3],{"/Bz5":function(t,e){},"6+aJ":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o("qG1x"),n=o("TIfe"),s={name:"mainP",components:{footerOh:i.a},data:function(){return{dialogVisible:!1,isLogin:!1,slogan:"",ossUrl:"https://snkae-1301702299.cos.ap-nanjing.myqcloud.com/",baseUrl:"http://47.97.192.85:5207/api/",count:0,queryForm:{page:0,pageSize:10},loginForm:{userName:"",password:""},rules:{userName:[{required:!0,trigger:"blur",message:"username"}],password:[{validator:function(t,e,o){""===e?o(new Error("password")):((e.length<6||e.length>16)&&o(new Error("长度至少6位,不超过16位")),o())},required:!0,trigger:"blur"}]},data:[]}},created:function(){var t=this;"822017161"===Object(n.b)()&&(this.isLogin=!0),this.query(),this.slogan=Object(n.a)(),void 0===this.slogan&&this.axios.get(this.baseUrl+"slogan").then(function(e){console.log(e.data.slogan),t.slogan=e.data.slogan,Object(n.d)(t.slogan)})},methods:{checkAuto:function(t){var e=t.content,o=e.indexOf("song/"),i=e.indexOf("/?userid");return-1!=i&&-1!=o?(t.autoId=e.substring(o+5,i),e.substring(o+5,i)):null},toAdmin:function(){this.$router.push({path:this.redirect||"/admin"})},login:function(){var t=this;this.$refs.loginForm.validate(function(e){e&&t.axios.post(t.baseUrl+"login",t.loginForm).then(function(e){200===e.data.code?(t.isLogin=!0,Object(n.e)(e.data.token),t.dialogVisible=!1,t.$router.push({path:t.redirect||"/admin"})):t.$message({type:"error",message:"密码或用户名错误"})})})},query:function(){var t=this;this.axios.post(this.baseUrl+"query",this.queryForm).then(function(e){t.count=e.data.count,e.data.data.forEach(function(e){t.data.push(e)})})},scroll:function(){var t=this,e=!1;window.onscroll=function(){var o=document.documentElement.offsetHeight-document.documentElement.scrollTop-window.innerHeight<=10;o||(e=!1),o&&!e&&(e=!0,t.queryForm.page+=1,t.data.length<t.count&&t.query())}}},mounted:function(){this.scroll()}},a={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"div_main"},[o("el-row",[t.isLogin?o("el-button",{staticStyle:{float:"right"},attrs:{type:"text",icon:"el-icon-right"},on:{click:t.toAdmin}},[t._v("admin")]):o("el-button",{staticStyle:{float:"right"},attrs:{size:"mini",type:"text"},on:{click:function(e){t.dialogVisible=!0}}},[o("i",{staticClass:"el-icon-s-promotion"}),t._v("\n      login")])],1),t._v(" "),o("h1",[t._v(t._s(t.slogan))]),t._v(" "),o("el-divider",[o("i",{staticClass:"el-icon-ship"})]),t._v(" "),o("el-timeline",[t._l(t.data,function(e,i){return o("el-timeline-item",{key:i,attrs:{color:"#67C23A",size:"large",type:"succuss",timestamp:e.contentDate,placement:"top"}},[null==t.checkAuto(e)?o("el-card",[o("p",{staticClass:"content"},[t._v(t._s(e.content))]),t._v(" "),e.pic?o("img",{staticStyle:{width:"100%",height:"95%"},attrs:{src:t.ossUrl+e.pic,fit:"cover"}}):t._e()]):o("iframe",{attrs:{frameborder:"no",border:"0",marginwidth:"0",marginheight:"0",height:"86",src:"//music.163.com/outchain/player?type=2&id="+e.autoId+"&auto=0&height=66"}})],1)}),t._v(" "),o("el-timeline-item",{attrs:{color:"#67C23A",size:"large",type:"succuss",timestamp:(new Date).toLocaleDateString()+" "+(new Date).toLocaleTimeString(),placement:"top"}}),t._v(" "),o("p",[t._v("End")])],2),t._v(" "),o("footerOh"),t._v(" "),o("el-dialog",{attrs:{title:"login",visible:t.dialogVisible,width:"90%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[o("el-form",{ref:"loginForm",attrs:{rules:t.rules,model:t.loginForm,"label-width":"20px;"}},[o("el-form-item",{attrs:{prop:"userName",label:"用户名"}},[o("el-input",{attrs:{placeholder:"输入用户名",clearable:""},model:{value:t.loginForm.userName,callback:function(e){t.$set(t.loginForm,"userName",e)},expression:"loginForm.userName"}})],1),t._v(" "),o("el-form-item",{attrs:{prop:"password",label:"密码"}},[o("el-input",{attrs:{type:"password",placeholder:"填写密码",clearable:"","show-password":!0},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.login()}},model:{value:t.loginForm.password,callback:function(e){t.$set(t.loginForm,"password",e)},expression:"loginForm.password"}})],1),t._v(" "),o("el-form-item",[o("el-button",{staticStyle:{float:"right"},attrs:{size:"small",type:"success",round:""},on:{click:function(e){return t.login()}}},[o("i",{staticClass:"el-icon-s-promotion"}),t._v(" login")])],1)],1)],1)],1)},staticRenderFns:[]};var r=o("VU/8")(s,a,!1,function(t){o("/Bz5")},"data-v-81f49c98",null);e.default=r.exports}});
//# sourceMappingURL=3.926421ee151aee731fca.js.map